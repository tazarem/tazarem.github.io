<html lang="ko">
    <!-- head -->
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>
      Coding Coconut
    </title>
    <!-- 스크립트들 쓰기~ -->
    <link rel="shortcut icon" href="/icon/favicon.ico" type="image/x-icon" />
    <link rel="icon" href="/icon/favicon.ico" type="image/x-icon" />

    <link rel="stylesheet" href="/libs/fontawesome5/all.css">
    <link rel="stylesheet" href="/css/nanumgothic_coding.css">
    <link rel="stylesheet" href="/css/nanumsquare_round.css">
    
    <link rel="stylesheet" href="/css/generic.css">
    <link rel="stylesheet" href="/css/header.css">
    <link rel="stylesheet" href="/css/widget.css">
    <link rel="stylesheet" href="/css/prologue.css">
    <link rel="stylesheet" href="/css/post.css">
    <link rel="stylesheet" href="/css/archives.css">
    <link rel="stylesheet" href="/css/guest.css">
    <link rel="stylesheet" href="/css/footer.css">

    <script src="/libs/jquery/jquery.js"></script>
    <script src="/js/tracker.js"></script>
    <script src="/js/imgoverlay.js"></script>

    
      <link rel="stylesheet" href="/css/searcher.css">
      <script src="/js/search.js"></script>
      <script type="text/javascript">      
        var search_path = "search.json";
        if (search_path.length == 0) {
          search_path = "search.json";
        }
        var path = "/" + search_path;
        searchFunc(path, 'local-search-input', 'local-search-result');
      </script>
   

   <link rel="stylesheet" href="/css/mobile.css">
   <link rel="stylesheet" href="/css/hide.css">

   <script src="/js/attacher.js"></script>

   <script>
    $(function(){
        draw_tracker()
    })
   </script>

<meta name="generator" content="Hexo 5.4.0"></head>
    <!-- head -->
    <body class="scroll">
    <div class="header-wrap">
    <div class="header">
        <div class="mobile-logo" >
            <!-- Coding Coconut -->

            <div class="header-btn" onclick="toTheTop()">
                <i class="fas fa-level-up-alt"
                ></i>
            </div>
            
                <div class="header-btn" id="searchToggler" onclick="toggleSearcher(this)">
                    <i class="fas fa-search"></i>
                </div>
            
        </div>
        <div class="menus">
            
                <a href="/prologue" class="header-btn ">
                    <i class="header-icon fas fa-user-astronaut"></i>
                    <div class="header-name">Prologue
                    </div>
                </a>
            
                <a href="/" class="header-btn ">
                    <i class="header-icon fas fa-satellite"></i>
                    <div class="header-name">Blog
                    </div>
                </a>
            
                <a href="/archives" class="header-btn ">
                    <i class="header-icon fas fa-meteor"></i>
                    <div class="header-name">Archives
                    </div>
                </a>
            
                <a href="/guest" class="header-btn ">
                    <i class="header-icon fas fa-rocket"></i>
                    <div class="header-name">Guest
                    </div>
                </a>
            
        </div>
    </div>
    
    <div class="header-display">
        <!-- 슬라이더나 위젯 넣어도 되고.. 헤더 이미지 넣어도 됨 -->
        <div class="header-title-zone" onclick="goToMain()">
            <div class="blog-title">
                Coding Coconut
            </div>
            <div class="blog-subtitle">
                개발 블로그
            </div>
        </div>
    </div>
    
        <!-- 검색 위젯 -->

<div class="search-widget">
    <div class="form-group">
        <i class="fas fa-search search-icon"></i>
        <input type="text" 
        id="local-search-input" 
        name="q" results="0"
        placeholder="Search Posts"
        class="st-search-input st-default-search-input form-control"
        />
    </div>  
    <div id="local-search-result"></div>
</div>

    
</div>


    <div class="contents">
        
 
    <!-- 페이지네이션 -->
    <div class="pagenater">
    <a class="extend prev" rel="prev" href="/page/8/">&lt;</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/10/">&gt;</a>
</div>


    
        <div class="post">
    <!-- 토픽 트래커. 작성할 것-->
<div class="left-widget">
        <div class="left-component category">
    <div class="title">
        <i class="fas fa-bookmark"></i>
        Category
    </div>
    <div class="category-zone">
        <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CI-CD/">CI/CD</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/CI-CD/Docker/">Docker</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Framework/">Framework</a><span class="category-list-count">4</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Framework/Express/">Express</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Framework/Hexo/">Hexo</a><span class="category-list-count">3</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/javascript/">javascript</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%EA%B8%B0%ED%83%80/">기타</a><span class="category-list-count">3</span></li></ul>
    </div>
</div>

        
    <div class="left-component topic-tracker">
        <div class="title">
            <i class="fas fa-thumbtack"></i>
            Topic Tracker
        </div>
        <div class="track-list">
    
        </div>
    </div>

    
        <div class="left-component tags">
    <div class="title">
        <i class="fas fa-tags"></i>
        Tags</div>
    <div class="tag-zone">
        <a href="/tags/Certbot/" style="font-size: 10px; color: #d17def">Certbot</a> <a href="/tags/asyncawait/" style="font-size: 10px; color: #d17def">asyncawait</a> <a href="/tags/bash/" style="font-size: 10px; color: #d17def">bash</a> <a href="/tags/cmd/" style="font-size: 10px; color: #d17def">cmd</a> <a href="/tags/dns/" style="font-size: 10px; color: #d17def">dns</a> <a href="/tags/docker/" style="font-size: 10px; color: #d17def">docker</a> <a href="/tags/domain/" style="font-size: 10px; color: #d17def">domain</a> <a href="/tags/github-page/" style="font-size: 10px; color: #d17def">github_page</a> <a href="/tags/hexo/" style="font-size: 20px; color: #7685d8">hexo</a> <a href="/tags/pm2/" style="font-size: 10px; color: #d17def">pm2</a> <a href="/tags/postman/" style="font-size: 10px; color: #d17def">postman</a> <a href="/tags/ssh/" style="font-size: 10px; color: #d17def">ssh</a> <a href="/tags/terminal/" style="font-size: 10px; color: #d17def">terminal</a> <a href="/tags/%EB%B9%84%EB%8F%99%EA%B8%B0/" style="font-size: 10px; color: #d17def">비동기</a> <a href="/tags/%EC%86%8D%EB%8F%84-%EA%B0%9C%EC%84%A0/" style="font-size: 10px; color: #d17def">속도 개선</a> <a href="/tags/%EC%8A%A4%ED%81%AC%EB%9E%A9/" style="font-size: 10px; color: #d17def">스크랩</a> <a href="/tags/%EC%9E%A1%EB%8B%B4/" style="font-size: 10px; color: #d17def">잡담</a>
    </div>
</div>

    <div class="left-component tothetop">
        <a class="title" onclick="toTheTop()">
            <i class="fas fa-chevron-up"></i>
            To the top
        </a>
    </div>
</div>


    <div class="right-widget">
    <!-- 스티커 어태쳐 -->

<div class="right-component sticker-attacher">
    <div class="title">
        <i class="fas fa-disease"></i>
        Stricker Attacher
    </div>
    <div class="sticker-list scroll">
        
            
                <div class="sticker-thumb">
                    <img src="/sticker/cocona.png">
                </div>
            
                <div class="sticker-thumb">
                    <img src="/sticker/ggyul.png">
                </div>
            
                <div class="sticker-thumb">
                    <img src="/sticker/pinkwhale.png">
                </div>
            
                <div class="sticker-thumb">
                    <img src="/sticker/sunnysideup.png">
                </div>
            
        
    </div>
    <div class="attacher-btn remove"
    onclick="attacher.toggleDeleteMode(this)">
        스티커 떼기
    </div>
    <div class="attacher-btn deleteAll"
    onclick="attacher.deleteAllSticker()">
        이 페이지의 스티커 전부 삭제
    </div>
</div>


    <div class="right-component recent-post">
    <div class="title">
        <i class="fas fa-bolt"></i>
        Recent Post
    </div>
    <div class="post-list">
        
              <a href="/2022/07/21/Github-Page%EC%97%90-%EC%BB%A4%EC%8A%A4%ED%85%80-%EB%8F%84%EB%A9%94%EC%9D%B8-%EC%97%B0%EA%B2%B0%ED%95%98%EA%B8%B0/">Github Page에 커스텀 도메인 연결하기</a>
          
              <a href="/2022/06/10/Hexo-%ED%85%8C%EB%A7%88-%EB%A7%8C%EB%93%A4%EA%B8%B0/">Hexo 테마 만들기</a>
          
              <a href="/2022/05/20/SSH%ED%82%A4%EB%A1%9C-%EB%A1%9C%EA%B7%B8%EC%9D%B8%ED%95%98%EB%8A%94-%EB%B2%95/">SSH키로 로그인하는 법</a>
          
              <a href="/2022/05/20/pm2%EC%99%80-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0%ED%99%94/">pm2와 클러스터화</a>
          
    </div>
</div>
    <div class=""></div>
</div>


    <div class="post-header">
        <div class="post-category">
            <a class="category-link" href="/categories/Framework/">Framework</a>  >  <a class="category-link" href="/categories/Framework/Hexo/">Hexo</a>
        </div>
        <div class="post-title">Hexo와 API 서버 간의 통신</div>
        <div class="post-date">
            <!-- 작성됨 -->
            <div class="post-date-write">2021-03-08 16:46:45</div>
        </div>
        <div class="post-tag">
            <a class="tag-none-link" href="/tags/hexo/" rel="tag">hexo</a>
        </div>
    </div>
    <div class="post-content">
        <p>Hexo 블로그에 서버 API를 이용하는 덧글 위젯을 직접 만들고 싶다면 참조할 수 있는 포스팅이다.<br>Hexo는 정적 웹 블로그를 빠르게 작성할 수 있도록 하는 데에 주요 목적이 있기 때문에, 쿼리를 통해 데이터를 가져오고 서버통신을 통해 html dom을 렌더링하는 로직에 대한 지원은 그다지 좋지 않다.<br> Hexo 공식 사이트에서 지원하는 플러그인, 또는 Disqus나 Utterances 와 같은 덧글 위젯이 있지만.. 이런 위젯은 커스터마이징이나 데이터 저장 방식이 유연하지 못하다는 게 사실이다.</p>
<p>요약해서 말하자면, 결국 개발자들의 입맞에 맞지 않기 때문에 커스텀 위젯을 만들고자 하는 것이다 ^^;;</p>
<blockquote>
<p>뭘 만들 것인가?</p>
</blockquote>
<p>Hexo처럼 정적 프레임워크와 같이 사용할 수 있는, 덧글 위젯을 만들려고 한다.</p>
<blockquote>
<p>어떻게 만들 것인가?</p>
</blockquote>
<p>Hexo와 호환되려면 어떻게 해야 할까?<br>Hexo는 정적 블로그형 웹페이지 제작에 최적화된 별도의 서버를 가지고 있다. 이 서버는 Hexo를 가동시킬 때 .md(마크다운) 파일을 html로 내려준다.</p>
<p>*문제점 : Hexo와 위젯 API서버가 다르기 때문에 크로스오리진 이슈가 발생한다.</p>
<p>:할 수 있는 방법</p>
<blockquote>
<p>위젯 따로 구동되는 방식을 이용해야 한다. 다른 웹페이지를 볼 수 있는 iframe 태그를 이용할수도 있고, 데이터만 전송받아 Hexo 상에서 DOM을 따로 그릴 수도 있다. 데이터 교환 방식은 ajax 또는 axios를 이용할 것이다.</p>
</blockquote>
<p>흐름 구상은 다음과 같다.</p>
<ol>
<li>Hexo에서 ajax 혹은 axios를 이용하여 데이터를 요청한다.</li>
<li>api를 통해 댓글 데이터를 전송한다.</li>
<li>전송된 데이터를 받아서 Hexo상에서 HTML DOM을 직접 그린다.</li>
</ol>
<p>..해서 다음과 같은 과정이 될 것이다.</p>
<ul>
<li>Hexo ajax 요청 =&gt; 위젯 API의 수신 및 응답 =&gt; Hexo ajax 응답 완료 =&gt; Hexo의 js로 DOM 렌더링</li>
</ul>
<blockquote>
<p>그렇다면 이제 뭘 이용해서 구현할까?</p>
</blockquote>
<p>페이지를 렌더링해서 iframe하는 방식도 해봤고 데이터만 받아와서 hexo상에서 렌더링하는 방식도 해봤는데<br>iframe은 크로스오리진 이슈 때문에 iframe 내부의 DOM을 조작하기가 까다로워서 ajax 요청을 통해 api 서버로부터 데이터를 받아와서<br>Hexo 측에서 댓글 위젯을 그리는 편을 택했다.</p>
<h3 id="1-Node-js-Express-프레임워크로-위젯이-가동될-서버-만들기"><a href="#1-Node-js-Express-프레임워크로-위젯이-가동될-서버-만들기" class="headerlink" title="1. Node.js Express 프레임워크로 위젯이 가동될 서버 만들기"></a>1. Node.js Express 프레임워크로 위젯이 가동될 서버 만들기</h3><!-- 이미지 -->
<p>express를 사용하여 api 서버의 틀을 잡는다.</p>
<!-- 이미지 -->
<p>댓글이 저장될 데이터베이스 또한 작성해야 한다.</p>
<h3 id="2-위젯-서버의-API-로직-작성하기"><a href="#2-위젯-서버의-API-로직-작성하기" class="headerlink" title="2. 위젯 서버의 API 로직 작성하기"></a>2. 위젯 서버의 API 로직 작성하기</h3><!-- 이미지 -->
<p>Node Express 서버에 기본 CRUD를 할 수 있도록 기능을 만든다.</p>
<h3 id="3-Hexo-ajax-요청-로직-작성"><a href="#3-Hexo-ajax-요청-로직-작성" class="headerlink" title="3. Hexo ajax 요청 로직 작성"></a>3. Hexo ajax 요청 로직 작성</h3><!-- 이미지 -->
<p>Hexo 댓글 위젯의 버튼을 누르면 ajax 또는 axios 를 통해 위에서 작성한 api에 데이터를 요청할 수 있도록 한다.</p>
<h3 id="4-댓글-DOM-렌더링-로직-작성"><a href="#4-댓글-DOM-렌더링-로직-작성" class="headerlink" title="4. 댓글 DOM 렌더링 로직 작성"></a>4. 댓글 DOM 렌더링 로직 작성</h3><!-- 이미지 -->
<p>데이터 전송이 끝나면 추가되는 댓글 또는 삭제되는 댓글을 렌더링할 수 있도록 html DOM 렌더러를 작성한다.</p>
<h3 id="5-댓글이-갱신되는것을-확인"><a href="#5-댓글이-갱신되는것을-확인" class="headerlink" title="5. 댓글이 갱신되는것을 확인"></a>5. 댓글이 갱신되는것을 확인</h3><!-- 이미지 -->
<p>댓글이 잘 작성된 것을 확인할 수 있었다.<br>지금은 익명 댓글이지만, 로그인 위젯을 만들어 놓으면 api 서버로부터 세션검증을 통해 유저검증을 하는 것도 가능할 것 같다.</p>

    </div>
    
    
        <div class="reply">
                
        <script src="https://utteranc.es/client.js"
        repo="tazarem/tazarem.github.io"
        issue-term="2021/03/08/Hexo와-API서버-간의-통신/"
        theme="github-light"
        crossorigin="anonymous"
        async>
        </script>
    
        </div>
    
</div>


    

    </div>
    <div class="overlay hide">
    <div class="img-zone">
        <div class="title"></div>
        <div class="content"></div>
    </div>
    <!-- <div class="btn-banner">
        <div class="btn close">
            <i class="fas fa-times"></i>
        </div>
        <div class="btn img-closer">
            <i class="fas fa-search-plus"></i>
        </div>
        <div class="btn img-wider">
            <i class="fas fa-search-minus"></i>
        </div>
    </div> -->
</div>
    <div class="footer">
    <div class="footer-contents">
        <div>Copyright 2021 코딩코코넛 All rights reserved.</div>
        <div>Powered by <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a></div>
    </div>
</div>
    </body>
</html>